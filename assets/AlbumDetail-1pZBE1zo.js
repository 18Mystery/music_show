import{_ as x,a as L,r as A,h as W,l as v,g as m,c as l,d as s,A as Y,t as g,F as S,i as k,n as _,e as y,J as z,o as n,p as F,q as f,y as G,w as H,s as p,b as J}from"./index-Cshm0C-f.js";import{_ as Q}from"./back-D1nyqv6V.js";import{_ as N}from"./collect-active-BZg33xkB.js";import{_ as Z}from"./play-DwFW73Pk.js";import{_ as M}from"./collect-uw9KXPlZ.js";import{_ as q,a as j,A as X}from"./AddToPlaylistPopup-DupXLtp7.js";const $="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAABGpJREFUaEPtmHvon3MUx19vSjSNSNtfIqLJEKuVW7KY5bKNiGxKYVgxC0tZ7pr7JdeRcr+OyX3kOlMusVwm15TkltzFP2/P6Xceffu17/d5nu/lt5bv+ev7fJ/PubzPOc+5fMR6TlrP7WcIYF1HcBiBYQR69MD/L4VsHwDsCOwAbA/8CXwL/AjcLenzTk61vR0wF5gITAA2Aj4EPgO+kPRCk6DUjoDtzYHzgAUdFPxegLoHWCTp19ZztjcDlhSGzgE27SDjWuACST/XAVILgO1ZafxuKfSH9Nq7wLbAfkAALOllYL6kj+IP25OBG4F9Ws4EwDeA94FdgF0zInHkvQSxvApEJQDbRwIPtQhaIOm6Ud6NNDgQOAk4NN99ApwGbABcn+kWr54AlgIrJP0zSs41oyJ8lKSHO4HoCMD2HsDbLQImSPq+IscPAcKQ+D5+KzwZOiJl4tsI8E9W8Affpy1npkh6px1PFYBb06vBX+mNUontqcDThee3yP9+ishIWlWVEplyewEr8+xSSfMaA7C9FVB6+3JJi+oobwFxGPB4Ps+SVP6uJcb2ZUWFOzsPT5T03doY20bAdnyYLyXT7pLig21Ets8A/pAUOd+IbE8B3kqm6ZJWNAUQyq9OpnGSot6PGdkeB0RZDjpL0pVNAZxclLWbk2mSpI/HzPqR0rtzlthQe4qkW5oCOAh4JpnmSooGNWZkOz7c0ugZkp5tCiBq+y9F99w46rik08fM+pEIRPQjC/4uUnn86J5R2lJVRu8s5pPjgNXA/pKiHA6cbEf5fTG784NF+h7dTmkVgNlFm380mW+SNH/g1o94P8aOU1PX4ZIe6wpAMBXT5+tF298zBcyRdO8gQdg+NgfCULNKUjS1tlRnForR966U8GVRmw+WtGYQIGxPAp7KATFUVHb/SgAZhfNzGo3HmEuOkPRVP0HY3jrTNeavWsbHoVoAEsSFwOIUHnPKbEmxxPRMtrdM4/dNYZdIOreO4NoAEsQVRXc8MwVHa48Z5686itqdKWaeTYBlwIw806hYNAKQIG6IZSWVLZcUlaprKjruI5GSKeABScc0EdYYQIK4Azg+Fd0nKSpHY7Jd9pngjQVnelMhXQFIEPcDZYO5XdKJTZS3dNpgWympdd2sLaprAAkidtaZqa32uGH7KmBh8r0pKRagrqgnAAniudyH43GJpHM6WWL7IqCsMKsllRcF6wZAgngN2DstWCzp4rVZYzvAXZrv1kjaqSurW5h6jkACiMk19t2yCS2UFIv9f2Q7bijK24xY8Cf3WoJDeF8AJIiYICMSpVfnlauk7ROA2xLN18WeMVXSN716v68AEkSMA68A26RxcQtnoBwA45JgmqQP+mF83wEkiIhAzPJx79lKcVU4U9Kr/TJ+IAASRJTFGDXGp7ExboTxz/fT+IEBSBDTcqeOq8WYmTreyHULrG8fcZuyGU1uQ0nlVtetnW35Bgqg79auReAQwFh4uZOOYQSGEejRA8MU6tGBPbP/C7xyY0BYqvEIAAAAAElFTkSuQmCC",tt={class:"albumDetail"},at={class:"bg"},st={class:"albumBox"},et={class:"left"},ot=["src"],lt={class:"right"},nt={class:"nameBox"},it={key:0},rt={class:"date"},ct={key:0,src:N,alt:""},ut={key:1,src:$,alt:""},dt={class:"songlist"},mt=["onClick"],gt={class:"left"},pt={key:0},At={class:"right"},vt=["onClick"],St={key:0,src:N,alt:""},kt={key:1,src:M,alt:""},_t=["onClick"],It={__name:"AlbumDetail",setup(bt){const P=z(),c=L(),u=A([]),o=A([]),d=A(!1),I=A(null),h=t=>{I.value.showPopup(t)};W(async()=>{const t=P.params.id;console.log(t),await v.getAlbumContent(t).then(a=>{u.value=a.songs.map(r=>({...r,isFavorite:!1})),o.value=a.album,console.log("albumSong:",u.value),console.log("albumDetail:",o.value),w()}),T(t)});const T=async t=>{try{const a=await m.checkFavoriteAlbumStatus({token:localStorage.getItem("TOKEN"),albumId:t});a.code===200&&(d.value=a.isFavorite)}catch(a){console.error("检查专辑收藏状态失败:",a)}},C=async()=>{try{if(d.value)await m.removeFavoriteAlbum({token:localStorage.getItem("TOKEN"),albumId:o.value.id});else{const t={token:localStorage.getItem("TOKEN"),albumId:o.value.id,albumName:o.value.name,artistId:o.value.artists[0].id,artistName:o.value.artists[0].name,artistImg:o.value.artists[0].img1v1Url,albumImg:o.value.picUrl,songNum:o.value.size};console.log("提交的专辑参数",t),await m.addFavoriteAlbum(t)}d.value=!d.value,p(d.value?"已收藏专辑":"已取消收藏专辑")}catch(t){console.error("切换专辑收藏状态失败:",t),p("操作失败")}},w=async()=>{for(const t of u.value)try{const a=await m.checkFavoriteStatus({token:localStorage.getItem("TOKEN"),songId:t.id});a.code===200&&(t.isFavorite=a.isFavorite)}catch(a){console.error("检查歌曲收藏状态失败:",a)}},E=async t=>{var a;try{if(t.isFavorite)await m.removeFavoriteSong({token:localStorage.getItem("TOKEN"),songId:t.id});else{const r=(a=t.al)==null?void 0:a.id;console.log("专辑 ID：",r);const e=await v.getAlbumContent(r),i=e.album.size;console.log("专辑内容：",e);const R=(await v.getSingerDetail(t.ar[0].id)).artist.img1v1Url,V={token:localStorage.getItem("TOKEN"),songId:t.id,songName:t.name,artistId:t.ar[0].id,artistName:t.ar[0].name,artistImg:R,albumId:t.al.id,albumName:t.al.name,albumImg:t.al.picUrl,songNum:i};await m.addFavoriteSong(V)}t.isFavorite=!t.isFavorite,p(t.isFavorite?"已收藏歌曲":"已取消收藏歌曲")}catch(r){console.error("切换歌曲收藏状态失败:",r),p("操作失败")}},O=t=>{c.addToNextInplayList(t),p("已添加到播放列表")};function K(t){const a=new Date(t),r=a.getFullYear(),e=String(a.getMonth()+1).padStart(2,"0"),i=String(a.getDate()).padStart(2,"0");return`${r}-${e}-${i}`}const U=t=>{c.clearPlayList(),c.addSongsToplayList([t]),c.playSong(t)},B=()=>{c.clearPlayList(),c.addSongsToplayList(u.value),u.value.length>0&&c.playSong(u.value[0])},D=t=>c.currentSong&&c.currentSong.id===t.id;return(t,a)=>{const r=J("van-cell");return n(),l("div",tt,[s("div",at,[s("div",{class:"bg-image",style:Y(`background-image: url(${o.value.picUrl});`)},null,4),a[2]||(a[2]=s("div",{class:"mask"},null,-1)),s("i",{onClick:a[0]||(a[0]=e=>t.$router.go(-1)),class:"back"},a[1]||(a[1]=[s("img",{src:Q,alt:""},null,-1)])),s("div",st,[s("div",et,[s("img",{src:o.value.picUrl,alt:""},null,8,ot)]),s("div",lt,[s("div",nt,[s("p",null,g(o.value.name),1),(n(!0),l(S,null,k(o.value.artists,(e,i)=>(n(),l("span",{key:e.id},[F(g(e.name),1),i!==o.value.artists.length-1?(n(),l("span",it," / ")):f("",!0)]))),128))]),s("span",rt,g(K(o.value.publishTime)),1),s("i",{class:"collect",onClick:_(C,["stop"])},[d.value?(n(),l("img",ct)):(n(),l("img",ut))])])]),a[3]||(a[3]=s("div",{class:"tabTitle"},null,-1))]),s("div",{class:"listTop"},[s("div",{class:"listTopLeft",onClick:B},a[4]||(a[4]=[s("i",null,[s("img",{src:Z,alt:""})],-1),s("span",null,"全部播放",-1)]))]),s("div",dt,[s("ul",null,[(n(!0),l(S,null,k(u.value,e=>(n(),l("li",{key:e.id,onClick:i=>U(e),class:G({"active-song":D(e)})},[s("div",gt,[s("p",null,g(e.name),1),s("p",null,[(n(!0),l(S,null,k(e.ar,(i,b)=>(n(),l("span",{key:i.id},[F(g(i.name),1),b!==e.ar.length-1?(n(),l("span",pt," / ")):f("",!0)]))),128))])]),s("div",At,[s("i",{onClick:_(i=>E(e),["stop"])},[e.isFavorite?(n(),l("img",St)):(n(),l("img",kt))],8,vt),s("i",{onClick:_(i=>O(e),["stop"])},a[5]||(a[5]=[s("img",{src:q,alt:""},null,-1)]),8,_t),s("i",null,[y(r,{onClick:i=>h(e.id)},{default:H(()=>a[6]||(a[6]=[s("img",{src:j,alt:""},null,-1)])),_:2},1032,["onClick"])])])],10,mt))),128))])]),y(X,{ref_key:"addToPlaylistPopup",ref:I},null,512)])}}},Tt=x(It,[["__scopeId","data-v-4d0344f0"]]);export{Tt as default};
