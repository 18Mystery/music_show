import{_ as L,a as U,r as d,c as l,d as t,f as V,v as B,F as y,i as h,q as S,e as k,l as f,g as m,o as n,y as R,t as p,p as b,n as T,w as q,s as g,b as X}from"./index-Ci3PLr0-.js";import{_ as D}from"./backSearch-D-eDlE1G.js";import{_ as K}from"./search-Bj0BaDWk.js";import{_ as G}from"./collect-active-BZg33xkB.js";import{_ as J}from"./collect-uw9KXPlZ.js";import{_ as M,a as O,A as H}from"./AddToPlaylistPopup-DVKz1sl2.js";const z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAAAAXNSR0IArs4c6QAAAgpJREFUSEu1lcFPE0EUxr+3NaJnhRu3bppASLxx0ANcPakXTnQVEkkAiybexb9A2wJGEtBt72A8mpCSaA+EgyaEJusWTEwwqQUMTUhb0p1nduwSLN2dtkn3uPPe7818++03hC4+FMR+bL29eTXUEyGmiAYaEsAtDfgmwDtMbJ05VWs5MnXox2gKn8unowzcA/N95cGI1gn4EA+PpxprL8FjljkPjV4ooY0Fgl8mIsb8xdf/wTsGe8SGAedwKQWz2faOGxqIyPAkOofH8um1ljRWTSdaT4THH7hlEv7EXu0lXPnt1/e8/y5+Vo6QLdk4qB6r8GDU+pL6RFHCZ+13IxpCmWZd/T03MNY3LJcEM7Kl79gq7QUOEHBGF/RHmxI+Z5vTDFpUwb31/XIRa4fbvgMIPBPXjSUJj9nmIkDTrcLduqqoIXnwyWcALyV0Y6aueSpDwEg7cLe2cHaCdCF7qY2BzaQeHa3LknrFwNN24KdOFW9+bTTdOQGv43r0WX3n5gSBVlqFux/084nlqzmDJ5O6sfrPLfn3tzXWvqjgDgt8PPqKvXIh2C0k7iyEH2Yl3E2/a9r1YpDPf1SKyPzJ4bh2qvR5RZR73bTs/h8qvd7NbJF+7zRuPaH8UtFb73iAKs+9AV27iS5awU1LBg2GoA0wMMigAQLnCNh1IHIE3nXTz88+gRe00nOKgr+npuwYrGV7TgAAAABJRU5ErkJggg==",Q={class:"search"},W={class:"header"},Y={class:"left"},$={class:"middle"},j={key:0,class:"content"},Z={class:"searchBox"},ss={class:"musicBox"},ts={class:"songlist"},os=["onClick"],as={class:"artist"},es={key:0},ls={class:"right"},ns=["onClick"],is={key:0,src:G,alt:""},rs={key:1,src:J,alt:""},cs=["onClick"],ds={__name:"SearchView",setup(us){const i=U(),u=d(""),v=d(!1),r=d([]),_=d(null),w=s=>{_.value.showPopup(s)},F=async()=>{try{const s=await f.getSearchSong(u.value);r.value=s.result.songs.map(o=>({...o,isFavorite:!1})),v.value=!0,console.log("搜索结果:",r.value),I()}catch(s){console.log(s)}},I=async()=>{for(const s of r.value)try{const o=await m.checkFavoriteStatus({token:localStorage.getItem("TOKEN"),songId:s.id});o.code===200&&(s.isFavorite=o.isFavorite)}catch(o){console.error("检查收藏状态失败:",o)}},P=async s=>{try{if(s.isFavorite)await m.removeFavoriteSong({token:localStorage.getItem("TOKEN"),songId:s.id});else{const o=s.album.id;console.log("专辑 ID：",o);const c=await f.getAlbumContent(o),a=c.album.picUrl,e=c.album.size;console.log("专辑内容：",c);const A={token:localStorage.getItem("TOKEN"),songId:s.id,songName:s.name,artistId:s.artists[0].id,artistName:s.artists[0].name,artistImg:s.artists[0].img1v1Url,albumId:s.album.id,albumName:s.album.name,albumImg:a,songNum:e};console.log("添加收藏参数：",A),await m.addFavoriteSong(A)}s.isFavorite=!s.isFavorite,g(s.isFavorite?"已收藏":"已取消收藏")}catch(o){console.error("切换收藏状态失败:",o),g("操作失败")}},C=s=>{i.addToNextInplayList(s),i.playSong(s)},E=()=>{if(r.value.length===0){console.log("没有可播放的歌曲");return}i.clearPlayList(),i.addSongsToplayList(r.value),i.playSong(r.value[0])},N=s=>{i.addToNextInplayList(s),g("已添加到播放列表")},x=s=>i.currentSong&&i.currentSong.id===s.id;return(s,o)=>{const c=X("van-cell");return n(),l("div",Q,[t("div",W,[t("div",Y,[t("i",{onClick:o[0]||(o[0]=a=>s.$router.go(-1))},o[2]||(o[2]=[t("img",{src:D,alt:""},null,-1)]))]),t("div",$,[o[3]||(o[3]=t("i",null,[t("img",{src:K,alt:""})],-1)),V(t("input",{placeholder:"请输入关键字","onUpdate:modelValue":o[1]||(o[1]=a=>u.value=a)},null,512),[[B,u.value]])]),t("div",{class:"btn"},[t("span",{onClick:F},"搜索")])]),v.value?(n(),l("div",j,[t("div",Z,[t("div",ss,[t("div",{class:"play"},[o[5]||(o[5]=t("div",null,"单曲",-1)),t("div",null,[t("i",{class:"playBtn",onClick:E},o[4]||(o[4]=[t("img",{src:z,alt:""},null,-1)]))])]),t("div",ts,[t("ul",null,[(n(!0),l(y,null,h(r.value,a=>(n(),l("li",{key:a.id,class:R({"active-song":x(a)})},[t("div",{class:"left",onClick:e=>C(a)},[t("p",null,p(a.name),1),t("p",as,[(n(!0),l(y,null,h(a.artists,e=>(n(),l("span",{key:e.id},[b(p(e.name)+" ",1),a.artists.indexOf(e)!==a.artists.length-1?(n(),l("span",es,"/")):S("",!0)]))),128)),b(" - "+p(a.album.name?a.album.name:a.name),1)])],8,os),t("div",ls,[t("i",{onClick:T(e=>P(a),["stop"])},[a.isFavorite?(n(),l("img",is)):(n(),l("img",rs))],8,ns),t("i",null,[t("img",{src:M,alt:"",onClick:T(e=>N(a),["stop"])},null,8,cs)]),t("i",null,[k(c,{onClick:e=>w(a.id)},{default:q(()=>o[6]||(o[6]=[t("img",{src:O,alt:""},null,-1)])),_:2},1032,["onClick"])])])],2))),128))])])])])])):S("",!0),k(H,{ref_key:"addToPlaylistPopup",ref:_},null,512)])}}},ys=L(ds,[["__scopeId","data-v-89faeb7f"]]);export{ys as default};
